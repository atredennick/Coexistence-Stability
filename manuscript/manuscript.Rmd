---
layout: 12pt
header-includes:
   - \usepackage{lineno}
   - \linenumbers
   - \usepackage{setspace}
   - \doublespacing
bibliography: ~/Dropbox/Bibliography/CoexistStability.bib
csl: components/ecology.csl

## rmarkdown render options
output:
  pdf_document:
    fig_caption: true
    keep_tex: true
fontsize: 12pt
geometry: margin=1in

---

How coexistence mechanisms mediate temporal stability
=====================================================

### Andrew T. Tredennick, Peter B. Adler, and Frederick R. Adler

*Andrew T. Tredennick ([atredenn@gmail.com](mailto:atredenn@gmail.com)), Department of Wildland Resources and the Ecology Center, Utah State University, Logan, UT*

*Peter B. Adler, Department of Wildland Resources and the Ecology Center, Utah State University, Logan, UT*

*Frederick R. Adler, Departments of Biology and Mathematics, University of Utah, Salt Lake City, UT*

```{r caching, include=FALSE}
library("methods")
library("knitr")
basename <- "manuscript"
opts_chunk$set(fig.path = paste("components/figure/", basename, "-", sep=""),
               cache.path = paste("components/cache/", basename, "/", sep=""))
opts_chunk$set(cache = 2)
opts_chunk$set(tidy=FALSE, warning=FALSE, message=FALSE, 
               comment = NA, verbose = TRUE, echo=FALSE)

# PDF-based figures
opts_chunk$set(dev='pdf')
```


```{r plot-options, message=FALSE, warning=FALSE, include=FALSE, echo=FALSE}
cbPalette <- c("#000000", "#E69F00", "#56B4E9", "#009E73", 
               "#F0E442", "#0072B2", "#D55E00", "#CC79A7")

opts_chunk$set(dev='pdf', dev.args=c(version="1.3"))

```

Introduction
------------
It is now clear that species richness tends to increase the temporal stability of biomass production in competitive plant communities. It is even becoming clear that a few core mechanisms related to compensatory dynamics among species through temporal or functional complementarity can explain the positive relationship between diversity and stability. What remains unclear is how the coexistence mechanism that maintains species richness influences the strength of compensatory dynamics. Theoretical studies based on Lotka-Volterra models have given us insight into the mechanisms that promote stability in communities where species coexist by fluctuation-independent mechanisms. A remaining challenge is to explore the importance of proposed mechanisms behind diversity-stability relationships in communities where species coexistence is maintained by temporal variability. Specifically, we seek to understand the mechanisms that promote temporal stability in communities where species coexistence is achieved because of temporal variability.

Theory highlights two classes of mechanisms that can stabilize communities and ecosystems by compensatory dynamics: (1) temporal complementarity among species and (2) functional complementarity among species. Temporal complementarity results in asynchronous population fluctations that, when aggregated over all populations in a community, dampens variability at the community or ecosystem level. Such asynchonry in population dynamics through time is driven by either species-specific responses to variable environmental conditions or differences in the rate at which species respond to disturbance. 

In contrast to temporal complementarity, functional complementarity increases community stability by reducing the strength of interspecific competition. Once thought to be stabilizing at the community level, recent work suggests interspecific competition is actually destabilizing. This is because functional complementarity and competition are negatively correlated, and functional complementarity among species (i.e., non-temporal niche differences) generally results in the productivity of species in mixture being greater than expected from monocultures. So called overyielding increases mean productivity more than its variance, leading to greater temporal stability.


To that end, we will analyze a general consumer-resource model under different coexistence assmptions. Our starting point is a model of two plant consumers and one resource (e.g., soil moisture or nitrogen). We will focus on three cases of species coexistence:

\begin{enumerate}
  \item Relative nonlinearty
  \item Temporal storage effect
  \item A combination of both mechanisms
\end{enumerate}

Each scenario requires different model assumptions and structure, so we will describe each in turn. Although the structure may change slightly to incorporate different coexistence mechanisms, the strength of our approach lies in the similarities among the models since we work under a unified consumer-resource framework.

Model description and analysis
------------------------------
### A general consumer-resource model

```{r figure_1, dependson="plot-options", fig.cap="Diagram of our semi-discrete consumer-resource model. Solid lines show continuous dynamics while dashed lines show the discrete transitions.", cache=FALSE, results='hide', fig.width=4, fig.height=6}
library(png)
library(grid)
img <- readPNG("ConceptFig.png")
grid.raster(img)
```

We start with a general consumer-resource model where the consumer can be in one of two-states: a dormant state $D$ and a live state $N$ (Figure~\ref{fig:model}). Transitions between $N$ and $D$ occur at discrete intervals $T$, so our model is formulated as ``pulsed differential equations" [@Pachepsky2008; @Mailleret2009]. For clarity we refer to $T$ as years and the growing time between years, $\tau$, as seasons. Seasonal (within-year) dynamics are modeled as three differential equations:

\begin{align}
\frac{\text{d}D_{i}}{\text{d}\tau} &= -(m_{D,i}D_{i})\\
\frac{\text{d}N_{i}}{\text{d}\tau} &= f_{i}(R)N_{i} - m_{N,i}N_{i}\\
\frac{\text{d}R_{i}}{\text{d}\tau} &= a(S - R) - \sum\limits_{i=1,2}f_{i}(R)N_{i}
\end{align}

where $i$ denotes species, $D$ is the dormant (long-lived) biomass state, $N$ is the living biomass (fast-growing, shorter-lived) state, and $m$s are biomass loss rates. The growth rate of living biomass is a resource-dependent function, $f_{i}(R) = r_{i}e^{-\alpha_{i}e^{-\beta_{i}R}}$. For the resource dynamics, whose state is denoted by $R$, we use a linear resource renewal equation where $a$ scales resource turnover rate and $S$ is the resource equilibrium when consumers are absent, and an offtake of the resource equal to the sum of each species' consumption, $\sum_{i=1,2}f(R)N_{i}$. Note that since transitions between $N$ and $D$ are pulsed, only biomass loss occurs throughout the season for $D$.

At the beginning of each season we start with initial conditions defined as $V_{t}$, $W_{t}$, and $Z_{t}$ for the dormant state, the live state, and the resource, respectively. So for each season, Eqs. 1-3 are solved given the initial conditions:
\begin{align}
  D_{i}(0) &= V_{i,t} \\
  N_{i}(0) &= W_{i,t} \\
  R(0) &= Z_{t}
\end{align}
The consumers transition between $N$ and $D$ instantaneously between years. We assume resource density does not change between years. So, at the yearly transition:
\begin{align}
  V_{i,t+1} &= [N_{i}(T^-)+D_{i}(T^-)](1-g_{t}) \\
  W_{i,t+1} &= [N_{i}(T^-)+D_{i}(T^-)]g_{t} \\
  Z_{t+1} &= R(T^-)
\end{align}
where $D(T^-)$, $N(T^-)$, and $R(T^-)$ are the densities of each state at the end of the year and $g$ is a time-fluctuating activation rate that regulates how much dormant biomass is converted to growing-season live biomass each year. Our formulation assumes that at the end of each season all accumulated living biomass [$N(T^-)$] is converted to dormant biomass.

\begin{center}
\begin{table}
\caption{Definition of model parameters.}
\begin{tabular}{l l}
\hline
Parameter & Definition \\
\hline
$m_{D}$ & dormant state mortality rate \\
$r$ & live state maximum resource uptake rate \\
$K$ & live state half-saturation constant for resource uptake rate \\
$m_{N}$ & live state mortality rate \\
$a$ & resource turnover rate \\
$S$ & resource supply rate \\
$g$ & dormant-to-live biomass transition fraction \\ 
\hline
\end{tabular}
\end{table}
\end{center}

### Implementing the storage effect
To make this a ``storage-effect" model, we need to satisfy three conditions: (1) the organisms must have a mechanism for persistence under unfavorable conditions, (2) species must respond differently to environmental conditions, and (3) the effects of competition on a species must be more strongly negative in good years relative to unfavorable years. Our model meets condition 1 because we include a dormant stage with very low death rates. We satisfy condition 2 with our model whenever $g$ is not perfectly correlated between species. Lastly, our model meets condition 3 because condition 2 partitions intraspecific and interspecific competition into different years. Thus, during a high $g$ year for one species, resource uptake is also inherently high for that species, which increases intraspecific competition relative to interspecific competition. So, given adequate variability in $g$, the inferior competitor (species with lower $r$) can persist. 

Following @Adler2008, we generated sequences of (un)correlated dormant-to-live state transition rates ($g$) for each species by drawing from multivariate normal distributions with mean 0 and a variance-covariance matrix of

\begin{align}
\begin{bmatrix}
\sigma^2_{E} & \rho\sigma^2_{E} \\
\rho\sigma^2_{E} & \sigma^2_{E}
\end{bmatrix}
\end{align}

\noindent{}where $\sigma^2_{E}$ is the variance and $\rho$ is the correlation between between the two species' transition rates. For environmental variability, here induced as variability in $g$, to promote coexistence via the storage effect, $\rho$ must be less than 1. The inferior competitor has the strongest potential to persist when $\rho=-1$ (perfectly uncorrelated transition rates). 

### Implementing relative nonlinearity
When considering consumer-resource dynamics, species coexistence by relative nonlinearity requires that each species has different nonlinear responses to resource availability, and resource availability must fluctuate through time. In a constant resource environment, the species with the lowest R* will always exclude the other species. So we can compare this model to the storage effect model, we still allow the germination rate \emph{g} to vary, but both species are perfectly correlate -- that is, $\rho=1$.  

Results
-------
### Storage effect model
Some preliminary results from running simulations of the storage effect version of the model at different levels of environmental cue variability ($\sigma_{E}$) and resource supply variability ($\sigma_{S}$). I ran 20 simulations at each combination of $\sigma_{E}$ and $\sigma_{S}$ shown in Figure~\ref{fig:storeEffSims} (the points are the means across the 20 simulations, each run for 2,000 time-steps, with the initial 1,000 time-steps discarded before calculating anything). There is a weak trend of community CV to saturate at high levels of resource supply variability (Figure~\ref{fig:storeEffSims}, top panel). 

One of the things we are interested in is how well the community buffers itself against resource variability. Really I should calculate some kind of asynchrony metric, but for now I just looked at the ratio of the resource CV to the community CV (Figure~\ref{fig:storeEffSims}, bottom panel). Kind of difficult to interpret, but it is interesting that at high levels of variability in the environmental cue that drives the storage effect, the ratio decreases with resource supply variability. The opposite occurs at lower levels of variability in the environmental cue.

\pagebreak{}

References
----------
