---
layout: 12pt
header-includes:
   - \usepackage{lineno}
   - \linenumbers
   - \usepackage[font={footnotesize},labelfont=bf]{caption}
bibliography: ~/Dropbox/Bibliography/CoexistStability.bib
csl: components/ecology.csl

## rmarkdown render options
output:
  pdf_document:
    fig_caption: true
    keep_tex: false
fontsize: 12pt
geometry: margin=1in
linkcolor: black
urlcolor: black
---

\begin{centering}

\textbf{\large{Revisiting how species coexist reveals positive and negative relationships between species richness and ecosystem stability}}



\vspace{2.5em}

\renewcommand*{\thefootnote}{\fnsymbol{footnote}}

Andrew T. Tredennick\textsuperscript{1,}\footnote{Corresponding author; email: atredenn@gmail.com}, Peter B. Adler\textsuperscript{1}, and Frederick R. Adler\textsuperscript{2}

\vspace{1.5em}

\textit{\small{\textsuperscript{1}Department of Wildland Resources and the Ecology Center, Utah State University, Logan, Utah 84322}}; \textit{\small{\textsuperscript{2}Departments of Biology and Mathematics, University of Utah, Salt Lake City, Utah}} 

\end{centering}

```{r caching, include=FALSE}
library("methods")
library("knitr")
basename <- "manuscript"
opts_chunk$set(fig.path = paste("components/figure/", basename, "-", sep=""),
               cache.path = paste("components/cache/", basename, "/", sep=""))
opts_chunk$set(cache = 2)
opts_chunk$set(tidy=FALSE, warning=FALSE, message=FALSE, 
               comment = NA, verbose = TRUE, echo=FALSE)

# PDF-based figures
opts_chunk$set(dev='pdf')
```


```{r plot-options, message=FALSE, warning=FALSE, include=FALSE, echo=FALSE}
cbPalette <- c("#000000", "#E69F00", "#56B4E9", "#009E73", 
               "#F0E442", "#0072B2", "#D55E00", "#CC79A7")

opts_chunk$set(dev='pdf', dev.args=c(version="1.3"))

```

\begin{abstract}
For biodiversity to increase the temporal stability of ecosystem function in the long-term, coexistence must be stable.
Species-specific respones to environmental variation through time is key to understanding fluctuation-dependent coexistence mechanisms and how asynchrony in species dynamics can arise to stabilize ecosystem function.
Despite the shared dependence on environmental fluctuations, theory on species coexistence and the relationship between species richness and ecosystem stability have developed independently.
To formally link the two bodies of theory, we use consumer-resource models where coexistence between two species utilizing a single resource is maintained by two fluctuation-dependent mechanisms: the storage effect and relative nonlinearity.
We examine how the strength of species coexistence relates to the temporal stability of aggregate ecosystem function and how the effect of environmental variability on stability is mediated by the mechanism of coexistence.
Blah, blah, blah...
\vspace{2em}

\noindent \textbf{Keywords}: coexistence, storage effect, relative nonlinearity, diversity-stability hypothesis, pulsed differential equation, consumer-resource dynamics, synchrony

\end{abstract}

\setlength{\parindent}{5ex}

Introduction
------------
The alarming rate of local species loss across the globe prompted three decades of theoretical and experimental work to understand the consequences of diversity loss [@Hooper2005].
One important consequence is that ecosystems may become more variable through time because species richness tends to confer ecosystem stability [@Loreau2013].
The prediction that the diversity-stability relationship is positive (richness begets stability) 

Empirical tests of the prediction that species richness increases ecosystem stability have relied on both experimental and observational approaches.
Experimental tests involve manipulating the number of species present in a plot by randomly drawing a specific number of species from a pre-defined species pool [@Hector1999; @Tilman2001].
Results from such experimental tests, which have focused on plant species richness and the temporal stability of aboveground biomass production, have been surprisingly consistent: temporal stability is greater in communities with more species [@Tilman2006; @Hector2010].
Observational tests of the DSR require sampling across natural diversity gradients

Species-specific responses to non-constant environmental conditions can stabilize species coexistence [@Chesson2000] and ecosystem function [@Loreau2010].
This means that fluctuation-dependent mechanisms of species coexistence are the very same mechanisms that link biodiversity and ecosystem function.
Yet, the theory that has developed over the past 20 years to explain the, generally, positive relationship between species richness and stability of ecosystem function has implicitly assumed species coexistence [@Loreau2010], or, when explicitly considered, coexistence is maintained by fluctuation-independent mechanisms [@Turnbull2013].
Despite rapid theoretical developments in the fields of species coexistence and biodiversity-ecosystem function, a gulf remains between the two lines of inquiry [@Carroll2011; @Turnbull2013].
This is especially surprising since stable coexistece, however maintained, is a preqrequisite for biodiversity to confer stability of ecosystem function in the long term.

Among the dizzying array of mechanisms that can maintain diversity, @Chesson2000 formalized two broad classes: fluctuation-independent and fluctuation-dependent mechanisms.
Both classes of mechanisms rely on niche differences being greater than relative fitness differences for all species pairs in a community [@Chesson2000; @Adler2007a].
In a fluctuation-independent case, species coexistence can be maintained by resource partitioning so long as each species is limited by a different resource [@Tilman1982].
Much of the theoretical literature aimed at deciphering the mechanisms behind the diversity-stability relationship implicitly assumes fluctuation-independent coexistence.
For example, Lotka-Volterra models have been widely used and include coexistence by keeping competition coefficients less than one [e.g., @Loreau2013].
Our focus, on the other hand, is on the interaction between species coexistence and ecosystem stability in communities where coexistence is dependent on environmental fluctuations.

There are two ways that species coexist in temporally fluctuating environments.
First, there is the storage effect, where species coexistence is stable if the following three conditions are met: (i) have unique responses to environmental conditions, (ii) have some way to persist in unfavorable years, and (iii) the effects of competition must be greater in 'good' years relative to 'bad' years [@Chesson2000].
Second, there is relative nonlinearity, where species have unique, nonlinear responses to a shared resource that fluctuates through time [@Chesson2000].

Both the storage effect and relative nonlinearity require that species have unique responses to environmental conditions.
Not only do such species-specific responses stabilize coexistence, they can also stabilize ecosystem function by creating compensatory dynamics.
All else being equal, ecosystem stability is highest when species responses to the environment are perfectly uncorrelated.
Under the storage effect, uncorrelated species responses to the environment also results in the most stable conditions for coexistence.
It stands to reason, then, that the strength of the storage effect should predict the degree to which species asynchrony stabilizes ecosystem function.
However, the exact relationship between storage effect strength and ecosystem stability could take many, unknown, forms.

Unlike the potential interaction between the storage effect and ecosystem stability, how relative nonlinearity might interact with ecosystem stability is less clear.



Model and Analysis
------------------
To discover how fluctuation-dependent coexistence mechanisms affect the diversity-stability relationship, we developed a semi-discrete consumer-resource model that allows many species to coexist on one resource by either the storage effect or relative nonlinearity. 
In our model, the consumer can be in one of two-states: a dormant state $D$ and a live state $N$.
The dormant state could represent, for example, the seedbank of an annual plant.
Transitions between $N$ and $D$ occur at discrete intervals $\tau$ with continuous-time consumer-resource dynamics between discrete transitions. 
Thus, our model is formulated as "pulsed differential equations" [@Pachepsky2008; @Mailleret2009; @Mordecai2016]. 
For clarity we refer to $\tau$ as years and the growing time between years as seasons with daily ($t$) time steps. 

During a growing season, consumer-resource dynamics are modeled as two differential equations:

\begin{align}
\frac{\text{d}N_{i}}{\text{d}t} &= N_{i}\epsilon_if_{i}(R), \quad t \ne \tau_k\\
\frac{\text{d}R}{\text{d}t} &= - \sum\limits_{i=1,2}f_{i}(R)N_{i}, \quad t \ne \tau_k
\end{align}

\noindent where the discrete transitions between $N$ and $D$ occur between seasons at times $\tau_k$, $k = 1,2,3, \dots, K$. The subscript $i$ denotes species, $N$ is the living biomass state, and $\epsilon_i$ is each species' resource-to-biomass conversion efficiency. The growth rate of living biomass is a resource-dependent Hill function, $f_{i}(R) = r_{i}R^{a_{i}} / (b_{i}^{a_{i}}+R^{a_{i}})$, where *r* is a species' intrinsic growth rate and *a* and *b* define the curvature of the function. Resource depletion is equal to the sum of each species' consumption. 

Along with resource uptake, consumer population growth depends on the production of dormant biomass ($D$), the activation of dormant biomass to live biomass ($D \rightarrow N$), and the survival of living biomass from one year to the next. The biomass of each species' states at the start of a growing season are equal to

\begin{align}
  D_{i}(\tau_k^+) &= (1-\gamma_{i,\tau_k})[\alpha_i N_{i}(\tau_k) + D_{i}(\tau_k)](1-\eta_i) \\
  N_{i}(\tau_k^+) &= (1-\alpha_i)N_{i}(\tau_k) + \gamma_{i,t}[\alpha_i N_{i}(\tau_k) + D_{i}(\tau_k)] (1-\eta_i),
\end{align}

\noindent where $D(\tau_k)$, $N(\tau_k)$, and $R(\tau_k)$ are the abundances of each state at the end of growing season *k* and $\tau_k^+$ denotes the beginning of growing season $k=1$. 
The activation of dormant biomass to live biomass is controlled by $\gamma$, which is year (*k*) and species (*i*) specific.
Dormant biomass is equal to a constant fraction ($\alpha$) of live biomass at the end of the previous season ($N_{i}(\tau_k)$), plus survival ($1-\eta_i$) of dormant biomass ($D_{i}(\tau_k)$) at the end of the previous year and dormant biomass remaining after live biomass activation ($D_{i}(\tau_k)(1-\gamma_{i,\tau_k})$).
Live biomass is equal to newly activated dormant biomass ($\gamma_{i,t}[D_{i}(\tau_k)$), minus some fraction of live biomass that is converted to dormant biomass ($(1-\alpha_i)N_{i}(\tau_k)$)
We assume the resource pool is not replenished within a growing season.
Resource replenishment occurs between growing seasons, and the resource pool (*R*) at the start of the growing season *k*+1 is $R(\tau_k^+) = R^+$, where $R^+$ is a random resource pulse drawn from a log-normal distribution with mean $\mu(R^+)$ and standard deviation $\sigma(R^+)$. 
Model parameters and notation are described in table 1.

\begin{centering}
\begin{table}
\footnotesize
\caption{Default values of model parameters and their descriptions. Parameters that vary depending on the mode and strength of species coexistence or depending on species copmetive hierarchies are labeled as "variable" in parantheses. The dormant-to-live biomass transition fraction ($\gamma$) is a function of other parameters, so has no default value.}
\begin{tabular}{l l l}
\hline
Parameter & Description & Value \\
\hline
$r$ & maximum per capita growth rate & 1 (variable) \\
$a$ & Hill function rate parameter & 2 (variable) \\
$b$ & Hill function curvature parameter & 2.5 (variable) \\
$\epsilon$ & resource-to-biomass conversion efficiency & 0.5 \\
$\alpha$ & allocation fraction of live biomass to dormant biomass & 0.5 (variable) \\
$\gamma$ & dormant-to-live biomass transition fraction & -- \\
$\rho$ & correlation of species' response to the environment & 0 (variable) \\
$\sigma_E$ & variance of the environmental cue & 2 (variable) \\
$\eta$ & dormant biomass mortality rate & 0.1 \\
$\mu(R^+)$ & mean annual resource pulse & 20 (non-log scale) \\
$\sigma(R^+)$ & standard deviation of annual resource pulse & 0 (variable) \\
\hline
\end{tabular}
\end{table}
\end{centering}

### Implementing the Storage Effect
To make this a storage effect model, we need to satisfy three conditions: (1) the organisms must have a mechanism for persistence under unfavorable conditions, (2) species must respond differently to environmental conditions, and (3) the effects of competition on a species must be more strongly negative in good years relative to unfavorable years. 
Our model meets condition 1 because we include a dormant stage with very low death rates. 
We satisfy condition 2 with our model whenever $\gamma$ is not perfectly correlated between species. 
Lastly, our model meets condition 3 because condition 2 partitions intraspecific and interspecific competition into different years. 
Thus, during a high $\gamma$ year for one species, resource uptake is also inherently high for that species, which increases intraspecific competition relative to interspecific competition. 
So, given adequate variability in $\gamma$, the inferior competitor can persist. 
We created competitive hierarchies in the storage effect version of the model by altering species' biomass conversion efficiencies ($\epsilon$)

We generated sequences of (un)correlated dormant-to-live state transition rates ($\gamma$) for each species by drawing from multivariate normal distributions with mean 0 and a variance-covariance matrix ($\Sigma(\gamma)$) of

\begin{align}
\Sigma(\gamma) = 
\begin{bmatrix}
\sigma^2_{E} & \rho\sigma^2_{E} \\
\rho\sigma^2_{E} & \sigma^2_{E}
\end{bmatrix}
\end{align}

\noindent where $\sigma^2_{E}$ is the variance of the environmental cue and $\rho$ is the correlation between between the two species' transition rates. $\rho$ must be less than 1 for stable coexistence.
The inferior competitor has the strongest potential to persist when $\rho=-1$ (perfectly uncorrelated transition rates). 

### Implementing Relative Nonlinearity
When considering consumer-resource dynamics, species coexistence by relative nonlinearity requires that each species has different nonlinear responses to resource availability, and resource availability must fluctuate through time.
In a constant resource environment, the species with the lowest $R*$ will always exclude the other species. 
To create competitive hierarchies among species we altered species resource uptake curves (Fig. SX).
We still allow the germination rate ($\gamma$) to vary, but both species are perfectly correlated -- that is, $\rho=1$ (Fig. 1). 


```{r model_types, cache=FALSE, warning=FALSE, message=FALSE, eval=TRUE, fig.height=3, fig.width=5, fig.cap="Resource uptake functions and example time series of (un)correlated germination fractions for the storage effect (*a,b*) and relative nonlinearity (*c,d*) formulations of the consumer-resource model. The resource uptake functions for both species are equivalent for the storage effect, but their germination fractions are uncorrelated in time. The opposite is true for relative nonlinearity: the two species have unique resource uptake functions, but their germination fractions are perfectly correlated in time."}
library(ggplot2)
library(ggthemes)
library(mvtnorm)
library(gridExtra)
# mycols <- c("#9D6188","#97A861")
# mycols <- c("black", "grey")
mycols <- c("grey35", "steelblue")

mytheme <- theme(axis.text=element_text(size=6),
                 axis.title=element_text(size=8),
                 legend.text=element_text(size=6),
                 legend.key.size=unit(0.3, "cm"))

 ##  Resource uptake function (Hill function)
  uptake_R <- function(r, R, alpha, beta){
    return((r*R^alpha) / (beta^alpha + R^alpha))
  }
  # Get "germination" fractions for each year
  getG <- function(sigE, rho, nTime){
    varcov <- matrix(c(sigE, rho*sigE, rho*sigE, sigE), 2, 2)
    e <- rmvnorm(n = nTime, mean = c(0,0), sigma = varcov)
    g <- exp(e) / (1+exp(e))
    return(g)
  }

## STORAGE EFFECT PLOTS
parms <- list(
  r = c(5,5),         # max growth rate for each species
  alpha = c(5,5),     # rate parameter for Hill function 
  beta = c(20,20),    # shape parameter for Hill function
  mN = c(0.5,0.5),    # live biomass loss (mortality) rates 
  mD = c(0.01, 0.01), # dormant biomass loss (mortality) rates
  a = c(0.5,0.5)      # allocation fraction of live biomass to seed bank
)
R <- seq(0,100,1)
out_r <- matrix(ncol=2, nrow=length(R))
alpha <- parms$alpha
beta <- parms$beta
for(i in 1:nrow(out_r)){
  out_r[i,1] <- uptake_R(parms$r[1], R[i], alpha[1], beta[1])
  out_r[i,2] <- uptake_R(parms$r[2], R[i], alpha[2], beta[2])
}
strg_uptake <- data.frame(species=rep(c(1:2), each=nrow(out_r)),
                          resource=rep(R, times=2),
                          uptake=c(out_r[,1], out_r[,2]))
strg_uptake_plot <- ggplot()+
  geom_line(data=strg_uptake, aes(x=resource, y=uptake, color=as.factor(species), linetype=as.factor(species)))+
  theme_few()+
  scale_color_manual(values=mycols, name="", labels=c("Species A", "Species B"))+
  guides(size=FALSE, linetype=FALSE)+
  xlab("Resource")+
  ylab("Resource Uptake Rate")+
  theme(legend.position=c(0.7,0.35))+
  geom_text(aes(x=1,y=5, label="a", size=8))+
  mytheme

sigE <- 2   # environmental cue variability
rho <- 0    # environmental cue correlation between species
gVec <- getG(sigE = sigE, rho = rho, nTime = 20)
germ_rate <- data.frame(species=rep(c(1:2),each=20),
                        timestep=rep(c(1:20), times=2),
                        germrate=c(gVec[,1], gVec[,2]))
strg_germ_plot <- ggplot()+
  geom_line(data=germ_rate,aes(x=timestep, y=germrate, color=as.factor(species), linetype=as.factor(species)))+
  theme_few()+
  scale_color_manual(values=mycols, name="Species")+
  guides(size=FALSE, linetype=FALSE, color=FALSE)+
  xlab("Simulation Year")+
  ylab("Germination Fraction")+
  geom_text(aes(x=1,y=1,label="b", size=8))+
  mytheme


## RELATIVE NONLINEARITY PLOTS
parms <- list(
  r = c(5,1),          # max growth rate for each species
  alpha = c(5,2),      # rate parameter for Hill function 
  beta = c(20,2.5),    # shape parameter for Hill function
  mN = c(0.5,0.5),     # live biomass loss (mortality) rates 
  mD = c(0.01, 0.01),  # dormant biomass loss (mortality) rates
  a = c(0.5,0.5)       # allocation fraction of live biomass to seed bank
)
R <- seq(0,100,1)
out_r <- matrix(ncol=2, nrow=length(R))
alpha <- parms$alpha
beta <- parms$beta
for(i in 1:nrow(out_r)){
  out_r[i,1] <- uptake_R(parms$r[1], R[i], alpha[1], beta[1])
  out_r[i,2] <- uptake_R(parms$r[2], R[i], alpha[2], beta[2])
}
reln_uptake <- data.frame(species=rep(c(1:2), each=nrow(out_r)),
                          resource=rep(R, times=2),
                          uptake=c(out_r[,1], out_r[,2]))
reln_uptake_plot <- ggplot()+
  geom_line(data=reln_uptake, aes(x=resource, y=uptake, color=as.factor(species), linetype=as.factor(species)))+
  theme_few()+
  scale_color_manual(values=mycols, name="Species")+
  guides(size=FALSE, linetype=FALSE, color=FALSE)+
  xlab("Resource")+
  ylab("Resource Uptake Rate")+
  geom_text(aes(x=1,y=5,label="c", size=8))+
  mytheme

sigE <- 2   # environmental cue variability
rho <- 1    # environmental cue correlation between species
gVec <- getG(sigE = sigE, rho = rho, nTime = 20)
germ_rate <- data.frame(species=rep(c(1:2),each=20),
                        timestep=rep(c(1:20), times=2),
                        germrate=c(gVec[,1], gVec[,2]))
reln_germ_plot <- ggplot()+
  geom_line(data=germ_rate,aes(x=timestep, y=germrate, color=as.factor(species), linetype=as.factor(species)))+
  theme_few()+
  scale_color_manual(values=mycols, name="Species")+
  guides(size=FALSE, linetype=FALSE, color=FALSE)+
  xlab("Simulation Year")+
  ylab("Germination Fraction")+
  geom_text(aes(x=1,y=1,label="d", size=8))+
  mytheme

g_strg <- grid.arrange(strg_uptake_plot, strg_germ_plot, 
                       reln_uptake_plot, reln_germ_plot,
                       ncol=2, nrow=2)
```

### Model Simulations
We simulated the model with four species under two scenarios for each coexistence mechanism.
First, we allowed the variance of the environment to determine how many species can coexist.
This required simulating communities with all species initially present across a gradient of annual resource variability (for relative nonlinearity) or environmental cue variability (for the storage effect).
Second, we chose parameter values that allowed coexistence of all four species, and performed species removals.
We ran simulations for 10,000 seasons with 20 day growing seasons. 
We averaged biomass over the growing season.
After discarding an initial 1,000 seasons to reduce transient effects on our results, we calculated the coffecient of variation of summed species biomass through time.
For simulations where environmental variability determined species coexistence, we calculated species richness as the number of species whose average biomass was greater than 1 over the course of the simulation.
Within-season dynamics were solved given initial conditions using the package ``deSolve`` [@Soetaert2010] in ``R`` [@Team2013].

Results and Discussion
----------------------
The direction of the diversity-variability relationship can be positive and negative when species coexistence is maintained by fluctuation-dependent mechanisms (Fig. 2).
Ecosystem variability is positively correlated with species richness when species richness is measured across a gradient of envrionmental variability, which maintains diversity and promotes ecosystem variability (Fig. 2a,b).
If environmental conditions are sufficient to maintain coexistence, removing species increases ecosystem variability (Fig. 2c,d).
Thus, our results both confirm and contrast with theoretical and experimental findings that diversity begets stability.

\begin{figure}[!ht]
  \centering
      \includegraphics[height=5in]{./components/main_figure.png}
  \caption{Variability of total community as function of species richness when coexistence is maintained by the storage effect (a,c) or relative nonlinearity (b,d). Top panels show results from simulations where environmental or resource variance determine the number species that coexist in a community. Bottom panels show results from simulations where environmental or resource variance is fixed at a level that allows coexistence of all four species, but speces are removed to manipulate diversity. In the most general sense, the top panels represent regional diversity-stability relationships across natural diversity gradients, whereas the bottom panels represent local diversity-stability relationships.}
\end{figure}

When we held environmental variability constant and removed species, we produced the typical negative diversity-variability relationship (Fig. 2c,d), consistent with theoretical expecations from models with species coexistence maintained by fluctuation-dependent mechanisms.
Likewise, our results from the species removal simulations are consistent with results from biodiversity-ecosystem functioning experiments showing a negative relationship between species richness and ecosystem variability.
This is encouraging because species almost certainly coexist by some combination of fluctuation-independent (e.g., resource partitioning) and fluctuation-dependent mechanisms.
By extending theory to communities where species richness is explicitly maintained by temporal variability, we have gained confidence that experimental findings are generalizable to many communities.
In other words, in local settings where environmental variability is relatively homogenous, reductions in the number of species will reduce the stability of ecosystem functioning, regardless of how coexistence is maintained.

When we allowed a gradient of environmental variability to determine species coexistence, we discoverd a positive relationship between species richness and ecosystem variability (Fig. 2a,b).
While surprising when viewed through the lens of previous theory and experimental findings, such a relationship is a direct consequence of how diversity can be maintained in fluctuating environments.
The storage effect and relative nonlinearity both require envrionmental fluctuations to allow niche differentiation between species pairs [@Chesson2000].
Therefore, species coexistence gains strength, for both mechanisms, as the envrionment becomes more variable (Fig. SX).

Our results may explain why deviations from the negative diversity-variability relationship often come from observational studies.
Observational studies must rely on natural diversity gradients, and if species richness depends environmental variability, it is entirely possible to observed positive diversity-variability relationships.
For example, Sasaki and Lauenroth (2011) found a negative relationship between species richness and the temporal stability of plant abundance (a positive diversity-variability relationship) in a semi-arid grassland.
Their data came from a six sites that were 6 km apart.
Thus, it is possible that each site experienced slightly different levels of environmental variability that influenced species coexistence.
Indeed, fluctuation-dependent coexistence mechanisms are particularly common in arid and semi-arid environments (CITATIONS).




<!---
\begin{figure}[!ht]
  \centering
      \includegraphics{./components/fig2_formatted.png}
  \caption{Variability of community biomass and invasion growth rates of the inferior competitor under different parameter combinations. Points are mean values from 10,000 growing seasons and lines are linear fits to show trends. In \textbf{Storage Effect} plots, resource supply is held constant between growing seasons, whereas resource supply varies each year in \textbf{Relative Nonlinearity} simulations.}
\end{figure}

\begin{figure}[!ht]
  \centering
      \includegraphics{./components/profile_plots_formatted.png}
  \caption{Variability of total community biomass and invasion growth rates of the inferior competitor when the storage effect is strong ($\rho=-0.5$) and weak ($\rho=0.5$), with (filled circles) and without (open circles) relative nonlinearity contributing to coexistence. Simulations without relative nonlinearity were run with species having (\emph{a}) low, (\emph{b}) moderate, and (\emph{c}) high maximum growth rates. Small plots above the main panels shows species resource uptake curves associated with each simulation.}
\end{figure}

\begin{figure}[!ht]
  \centering
      \includegraphics[width=3in]{./components/persp_plots_formatted.png}
  \caption{Variability of total community biomass (\emph{a}) and species richness (\emph{b}) as a function of the variance of the environmental cue ($\sigma^2_E$), and the correlation of species responses to the environment ($\rho$). }
\end{figure}

\begin{figure}[!ht]
  \centering
      \includegraphics{./components/diversity_stability_relationship.png}
  \caption{Variability of total community biomass as a function of the the number of coexisting species at different levels of correlations of species' responses to environmental conditions ($\rho$).}
\end{figure}

\begin{figure}[!ht]
  \centering
      \includegraphics{./components/storage_effect_growthrate_cv.png}
  \caption{Relationship between the strength of coexistence (invasion growth rate of inferior competitor) and ecosystem variability. Panels show different levels of environmental cue variability (denoted by number at top of each panel). Color bar shows the correlation between species' germination rates.}
\end{figure}

\begin{figure}[!ht]
  \centering
      \includegraphics{./components/storage_effect_synchstability.png}
  \caption{Results from storage effect simulations showing the relationships between the correlation of species' responses to the environmental cue for germination and simulated species asynchrony (\textit{a}), coefficient of variation of total community biomass (\textit{b}), mean total community biomass (\textit{c}), and standard deviation of total community biomass (\textit{d}). Color ramps indicate the value of resource variability ($\sigma_R$) for a given simulation.}
\end{figure}

\begin{figure}[!ht]
  \centering
      \includegraphics{./components/relative_nonlinearity_synchstability.png}
  \caption{Results from relative nonlinearity simulations showing the relationships between tresource variability ($\sigma_R$) and simulated species asynchrony (\textit{a}), coefficient of variation of total community biomass (\textit{b}), mean total community biomass (\textit{c}), and standard deviation of total community biomass (\textit{d}). The correlation of species' responses to the environmental cue for germination was equal to one for all relative nonlinearity simulations ($\rho=1$).}
\end{figure}


\begin{figure}[!ht]
  \centering
      \includegraphics[width=3in]{./components/strength_v_cv.png}
  \caption{Relationship between the strength of coexistence (invasion growth rate of inferior competitor) and ecosystem variability.}
\end{figure}

\begin{figure}[!ht]
  \centering
      \includegraphics{./components/compare_plots.png}
  \caption{Relationship between resource variability ($\sigma_R$) and the coefficient of variation of total community biomass for both coexistence mechanisms. Each panel shows results from different levels of environmental cue correlations ($\rho$) for the storage effect; $\rho=1$ across all panels for relative nonlinearity results. On average, the storage effect leads to less variable biomass production through time.}
\end{figure}

-->

\pagebreak{}

Acknowledgments
---------------
The National Science Foundation provided funding for this work through a Postdoctoral Research Fellowship in Biology to ATT (DBI-######) and a CAREER award to PBA (DEB-#######).

\setlength{\parindent}{0ex}

References
----------
